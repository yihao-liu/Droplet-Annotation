# Documentation: Droplet Tracking Annotation (Manually) Tool

## Overview

The Droplet Tracking Annotation Tool is an interactive Python-based application designed for the annotation and refinement of droplet tracking data. It facilitates the detailed examination of tracked droplets across sequential frames, allowing users to annotate, verify, and refine tracking data with precision and ease. The refined results can be used to enhance the accuracy of droplet tracking analysis by correcting errors in automated tracking data.

## Features

- **Data Refinement**: Merges tracking data of droplets across sequential frames, focusing on consistency and accuracy.
- **Interactive Annotation**: Enables users to manually annotate tracking data for verification and refinement purposes.
- **Customizable Visualization**: Offers adjustable visualization features for detailed inspection of droplets across frames.

## Usage

To use the tool, run the script from the command line with the required arguments:

```python
python annotation_widget.py <image_name> [options]
```

### Command Line Arguments
- **image_name**: Name of the image file for processing.
- **-v, --verbose**: (Optional) Sets the verbosity level of the script (0 for silent, 1 for verbose).
- **-h, --help**: (Optional) Displays help message and exits.

### Interactive Interface
The tool presents an interface with the following features:

- **Image Display**: Shows images of droplets across sequential frames based on tracking results.
- **Navigation Buttons**: Use 'Prev' and 'Next' buttons to navigate through frames.
- **Annotation Buttons**: 'True', 'Unsure', and 'False' buttons allow you to label the correctness of droplet tracking and the 'Delete' button removes the current annotation.
- **TextBox**: Jump to a specific tracked droplets result by entering the row number.
- **Row Number**: Displays the current tracked droplet's row number.

![Interface](./interface.png)

### Keyboard Shortcuts
- **Right Arrow**: Move to the next frame.
- **Left Arrow**: Move to the previous frame.
- **z**: Mark the current frame as 'True'.
- **x**: Mark the current frame as 'Unsure'.
- **c**: Mark the current frame as 'False'.
- **v**: Delete the current annotation.

### Saving Annotations

When you close the tool, it automatically saves the annotations in a CSV file located in the `dslab/data/05_results` directory with the name `refined_results_<image_name>.csv`.

## Enhancing Droplet Tracking Tasks

The results generated by this tool can be use for the enhancement of droplet tracking tasks by:

- Allowing manual verification and correction of automated tracking data.
- Providing a user-friendly interface for non-programmers in lab settings.
- Enabling researchers to fine-tune tracking data for more accurate scientific analysis. For tracking based on **Voting System**, the refined results can be used to adjust the weights of the parameter as well as the cost function. For tracking based on **Optimal Transport**, the refined results can be used to adjust the cost function, e.g., by assigning `inf` to the tracked droplet with label `False` and `0` to the tracked droplet with label `True`.

## Troubleshooting

- Issue: The script does not run.
Solution: Ensure all dependencies are installed and that the script is called with the correct arguments.
- Issue: Images are not displaying correctly.
Solution: Verify the image paths and formats are compatible with the script.
For further issues, please contact the author.

## Author
- **Name**: Yihao Liu
- **Email**: yihao_work@outlook.com